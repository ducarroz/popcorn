"use strict";function graphOt(e,i){for(var t,s=(i.length+1)*(e.length+1),a=Array(s),u=Array(i.length+1),n=Array(i.length+1),l=0;e.length+1>l;l++){for(var r=0;i.length+1>r;r++){var o,c;if(0===l&&0===r)o=" ",c=0;else if(0===l)o="insert",c=r;else if(0===r)o="delete",c=l;else if(e[l-1]===i[r-1])o="retain",c=n[r-1];else{var m=u[r-1],d=n[r];m>d?(o="delete",c=d+1):(o="insert",c=m+1)}a[l+r*(e.length+1)]=o,u[r]=c}t=u,u=n,n=t}return{edges:a,cost:n[i.length],source:i,target:e}}function traceOt(e){for(var i,t,s=[],a=e.edges,u=i=e.target.length,n=e.source.length;i||n;){var l=a[i+n*(u+1)];if("delete"===l){if(t&&"delete"===t[0])t[1]++;else{var r=["delete",1];t=r,s.push(r)}i--}else if("insert"===l){if(t&&"insert"===t[0])t[1]++;else{var r=["insert",1];t=r,s.push(r)}n--}else if("retain"===l){var r=["retain",1];t&&"retain"===t[0]?t[1]++:(t=r,s.push(r)),i--,n--}}return s.reverse(),s}function ot(e,i){return traceOt(graphOt(e,i))}function diff(e,i){for(var t=ot(e,i),s=[],a=0,u=0,n=0;t.length>n;){var l=t[n++];if("insert"===l[0])s.push([u,0,i.slice(u,u+l[1])]),u+=l[1];else if("delete"===l[0])if(t.length>n&&"insert"===t[n][0]){var r=t[n++];s.push([u,l[1],i.slice(u,u+r[1])]),a+=l[1],u+=r[1]}else s.push([u,l[1]]),a+=l[1];else"retain"==l[0]&&(a+=l[1],u+=l[1])}return s}function apply(e,i){for(var t=0;i.length>t;t++)e.swap.apply(e,i[t])}function merge(e,i){apply(e,diff(e,i))}require("collections/shim"),exports.graphOt=graphOt,exports.traceOt=traceOt,exports.ot=ot,exports.diff=diff,exports.apply=apply,exports.merge=merge;