montageDefine("99596c3","compile-assigner",{dependencies:["./compile-evaluator","./algebra","./scope"],factory:function(e,i,t){function s(e){return s.semantics.compile(e)}var a=e("./compile-evaluator"),u=e("./algebra");e("./scope");var n={type:"value"},l={type:"literal",value:!0},r={type:"literal",value:!1};t.exports=s,s.semantics={compile:function(e){var i=this.compilers;if("equals"===e.type){var t=this.compile(e.args[0]),s=this.compileEvaluator(e.args[1]);return i.equals(t,s)}if("if"===e.type){var a=this.compileEvaluator(e.args[0]),l=this.compile(e.args[1]),r=this.compile(e.args[2]);return i["if"](a,l,r)}if("and"===e.type||"or"===e.type){var o=u(e.args[0],n),c=u(e.args[1],n),m=this.compileEvaluator(e.args[0]),s=this.compileEvaluator(e.args[1]),d=this.compileEvaluator(o[1]),p=this.compileEvaluator(c[1]),t=this.compile(o[0]),v=this.compile(c[0]);return i[e.type](t,v,m,s,d,p)}if("everyBlock"===e.type){var g=this.compileEvaluator(e.args[0]),h=u(e.args[1],{type:"literal",value:!0}),b=this.compile(h[0]),f=this.compileEvaluator(h[1]);return i.everyBlock(g,b,f)}if("parent"===e.type){var q=this.compile(e.args[0]);return function(e,i){return q(e,i.parent)}}if(i.hasOwnProperty(e.type)){var S=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return i[e.type].apply(null,S)}throw Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:a,compilers:{property:function(e,i){return function(t,s){var a=e(s);if(a){var u=i(s);null!=u&&(Array.isArray(a)?a.set(u,t):a[u]=t)}}},get:function(e,i){return function(t,s){var a=e(s);if(a){var u=i(s);null!=u&&a.set(u,t)}}},has:function(e,i){return function(t,s){var a=e(s);if(a){var u=i(s);null!=t&&(t?(a.has||a.contains).call(a,u)||a.add(u):(a.has||a.contains).call(a,u)&&(a.remove||a["delete"]).call(a,u))}}},equals:function(e,i){return function(t,s){return t?e(i(s),s):void 0}},"if":function(e,i,t){return function(s,a){var u=e(a);if(null!=u)return u?i(s,a):t(s,a)}},and:function(e,i,t,s,a,u){return function(n,r){null!=n&&(n?(e(a(l),r),i(u(l),r)):e(t(r)&&!s(r),r))}},or:function(e,i,t,s,a,u){return function(n,l){null!=n&&(n?e(t(l)||!s(l),l):(e(a(r),l),i(u(r),l)))}},rangeContent:function(e){return function(i,t){var s=e(t);s&&(i?s.swap(0,s.length,i):s.clear())}},mapContent:function(e){return function(i,t){var s=e(t);s&&(s.clear(),t.value&&s.addEach(i))}},reversed:function(e){return function(i,t){var s=e(t);s&&s.swap(0,s.length,i.reversed())}},everyBlock:function(e,i,t){return function(s,a){if(s){var u=e(a),n=t(a);u.forEach(function(e){i(n,a.nest(e))})}}}}}}});