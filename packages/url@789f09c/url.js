(function(){"use strict";function e(e,n,i){if(e&&"object"==typeof e&&e.href)return e;if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o={},l=e;l=l.trim();var c=s.exec(l);if(c){c=c[0];var L=c.toLowerCase();o.protocol=L,l=l.substr(c.length)}if(i||c||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var y="//"===l.substr(0,2);!y||c&&f[c]||(l=l.substr(2),o.slashes=!0)}if(!f[c]&&(y||c&&!_[c])){var C=l.indexOf("@");if(-1!==C){for(var w=l.slice(0,C),M=!0,x=0,z=d.length;z>x;x++)if(-1!==w.indexOf(d[x])){M=!1;break}M&&(o.auth=decodeURIComponent(w),l=l.substr(C+1))}for(var E=-1,x=0,z=h.length;z>x;x++){var S=l.indexOf(h[x]);-1!==S&&(0>E||E>S)&&(E=S)}-1!==E?(o.host=l.substr(0,E),l=l.substr(E)):(o.host=l,l="");for(var T=a(o.host),P=Object.keys(T),x=0,z=P.length;z>x;x++){var D=P[x];o[D]=T[D]}o.hostname=o.hostname||"";var O="["===o.hostname[0]&&"]"===o.hostname[o.hostname.length-1];if(o.hostname.length>p)o.hostname="";else if(!O)for(var A=o.hostname.split(/\./),x=0,z=A.length;z>x;x++){var k=A[x];if(k&&!k.match(m)){for(var B="",I=0,j=k.length;j>I;I++)B+=k.charCodeAt(I)>127?"x":k[I];if(!B.match(m)){var R=A.slice(0,x),F=A.slice(x+1),N=k.match(g);N&&(R.push(N[1]),F.unshift(N[2])),F.length&&(l="/"+F.join(".")+l),o.hostname=R.join(".");break}}}if(o.hostname=o.hostname.toLowerCase(),!O){for(var q=o.hostname.split("."),V=[],x=0;q.length>x;++x){var W=q[x];V.push(W.match(/[^A-Za-z0-9_-]/)?"xn--"+r.encode(W):W)}o.hostname=V.join(".")}o.host=(o.hostname||"")+(o.port?":"+o.port:""),o.href+=o.host,O&&(o.hostname=o.hostname.substr(1,o.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!v[L])for(var x=0,z=u.length;z>x;x++){var U=u[x],Y=encodeURIComponent(U);Y===U&&(Y=escape(U)),l=l.split(U).join(Y)}var H=l.indexOf("#");-1!==H&&(o.hash=l.substr(H),l=l.slice(0,H));var K=l.indexOf("?");return-1!==K?(o.search=l.substr(K),o.query=l.substr(K+1),n&&(o.query=b.parse(o.query)),l=l.slice(0,K)):n&&(o.search="",o.query={}),l&&(o.pathname=l),_[c]&&o.hostname&&!o.pathname&&(o.pathname="/"),(o.pathname||o.search)&&(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=t(o),o}function t(t){"string"==typeof t&&(t=e(t));var n=t.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var i=t.protocol||"",a=t.pathname||"",r=t.hash||"",s=!1,o="";void 0!==t.host?s=n+t.host:void 0!==t.hostname&&(s=n+(-1===t.hostname.indexOf(":")?t.hostname:"["+t.hostname+"]"),t.port&&(s+=":"+t.port)),t.query&&"object"==typeof t.query&&Object.keys(t.query).length&&(o=b.stringify(t.query));var l=t.search||o&&"?"+o||"";return i&&":"!==i.substr(-1)&&(i+=":"),t.slashes||(!i||_[i])&&s!==!1?(s="//"+(s||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),l&&"?"!==l.charAt(0)&&(l="?"+l),i+s+a+l+r}function n(e,n){return t(i(e,n))}function i(n,i){if(!n)return i;if(n=e(t(n),!1,!0),i=e(t(i),!1,!0),n.hash=i.hash,""===i.href)return n.href=t(n),n;if(i.slashes&&!i.protocol)return i.protocol=n.protocol,_[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=t(i),i;if(i.protocol&&i.protocol!==n.protocol){if(!_[i.protocol])return i.href=t(i),i;if(n.protocol=i.protocol,!i.host&&!f[i.protocol]){for(var a=(i.pathname||"").split("/");a.length&&!(i.host=a.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),""!==a[0]&&a.unshift(""),2>a.length&&a.unshift(""),i.pathname=a.join("/")}return n.pathname=i.pathname,n.search=i.search,n.query=i.query,n.host=i.host||"",n.auth=i.auth,n.hostname=i.hostname||i.host,n.port=i.port,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.slashes=n.slashes||i.slashes,n.href=t(n),n}var r=n.pathname&&"/"===n.pathname.charAt(0),s=void 0!==i.host||i.pathname&&"/"===i.pathname.charAt(0),o=s||r||n.host&&i.pathname,l=o,c=n.pathname&&n.pathname.split("/")||[],a=i.pathname&&i.pathname.split("/")||[],u=n.protocol&&!_[n.protocol];if(u&&(delete n.hostname,delete n.port,n.host&&(""===c[0]?c[0]=n.host:c.unshift(n.host)),delete n.host,i.protocol&&(delete i.hostname,delete i.port,i.host&&(""===a[0]?a[0]=i.host:a.unshift(i.host)),delete i.host),o=o&&(""===a[0]||""===c[0])),s)n.host=i.host||""===i.host?i.host:n.host,n.hostname=i.hostname||""===i.hostname?i.hostname:n.hostname,n.search=i.search,n.query=i.query,c=a;else if(a.length)c||(c=[]),c.pop(),c=c.concat(a),n.search=i.search,n.query=i.query;else if("search"in i){if(u){n.hostname=n.host=c.shift();var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return n.search=i.search,n.query=i.query,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=t(n),n}if(!c.length)return delete n.pathname,n.search?delete n.path:n.path="/"+n.search,n.href=t(n),n;for(var d=c.slice(-1)[0],p=(n.host||i.host)&&("."===d||".."===d)||""===d,m=0,g=c.length;g>=0;g--)d=c[g],"."==d?c.splice(g,1):".."===d?(c.splice(g,1),m++):m&&(c.splice(g,1),m--);if(!o&&!l)for(;m--;m)c.unshift("..");!o||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),p&&"/"!==c.join("/").substr(-1)&&c.push("");var v=""===c[0]||c[0]&&"/"===c[0].charAt(0);if(u){n.hostname=n.host=v?"":c.length?c.shift():"";var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return o=o||n.host&&c.length,o&&!v&&c.unshift(""),n.pathname=c.join("/"),(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=i.auth||n.auth,n.slashes=n.slashes||i.slashes,n.href=t(n),n}function a(e){var t={},n=o.exec(e);return n&&(n=n[0],":"!==n&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e),t}var r=require("punycode");exports.parse=e,exports.resolve=n,exports.resolveObject=i,exports.format=t;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=["<",">",'"',"`"," ","\r","\n","	"],c=["{","}","|","\\","^","~","`"].concat(l),u=["'"].concat(l),h=["%","/","?",";","#"].concat(c).concat(u),d=["/","@","?","#"].concat(l),p=255,m=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,g=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,v={javascript:!0,"javascript:":!0},f={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=require("querystring")})();