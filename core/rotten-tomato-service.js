var Montage=require("montage/core/core").Montage,RangeController=require("montage/core/range-controller").RangeController,CategoryController=require("./category-controller").CategoryController,sharedTransport=require("./jsonp-transport").shared,API_KEY="edvr96kp6mddwsasvmt269pw",BOX_OFFICE_FEED="http://api.rottentomatoes.com/api/public/v1.0/lists/movies/box_office.json?limit=15&country=us&apikey="+API_KEY,UPCOMING_FEED="http://api.rottentomatoes.com/api/public/v1.0/lists/movies/upcoming.json?page_limit=30&page=1&country=us&apikey="+API_KEY,TOP_RENTALS_FEED="http://api.rottentomatoes.com/api/public/v1.0/lists/dvds/top_rentals.json?limit=20&country=us&apikey="+API_KEY,IN_THEATERS_FEED="http://api.rottentomatoes.com/api/public/v1.0/lists/movies/in_theaters.json?page_limit=30&page=1&country=us&apikey="+API_KEY;exports.RottenTomatoService=Montage.specialize({constructor:{value:function(){this.super(),this.categories=(new RangeController).initWithContent([]),this.categories.avoidsEmptySelection=!0}},load:{value:function(){var e=this;e.latestBoxOffice=new CategoryController("Box Office","box_office"),e.upcoming=new CategoryController("Upcoming","upcoming"),e.topDvdRentals=new CategoryController("Rentals","rentals"),e.inTheaters=new CategoryController("In Theaters","in_theaters");var o=this.loadLatestBoxOfficeMovies().then(function(o){e.latestBoxOffice.contentController.content=o,e.categories.content.push(e.latestBoxOffice,e.inTheaters,e.upcoming,e.topDvdRentals),e.categories.select(e.latestBoxOffice)});return o.then(function(){return[e.loadUpcomingMovies(),e.loadTopDvdRentals(),e.loadInTheaters()]}).spread(function(o,t,r){e.upcoming.contentController.content=o,e.topDvdRentals.contentController.content=t,e.inTheaters.contentController.content=r}).done(),o}},categories:{value:null},latestBoxOffice:{value:null},upcoming:{value:null},topDvdRentals:{value:null},inTheaters:{value:null},loadLatestBoxOfficeMovies:{value:function(){return sharedTransport.makeRequest(BOX_OFFICE_FEED,"rottenTomato").then(function(e){return e.movies})}},loadUpcomingMovies:{value:function(){return sharedTransport.makeRequest(UPCOMING_FEED,"rottenTomato").then(function(e){return e.movies})}},loadTopDvdRentals:{value:function(){return sharedTransport.makeRequest(TOP_RENTALS_FEED,"rottenTomato").then(function(e){return e.movies})}},loadInTheaters:{value:function(){return sharedTransport.makeRequest(IN_THEATERS_FEED,"rottenTomato").then(function(e){return e.movies})}}}),exports.shared=new exports.RottenTomatoService;